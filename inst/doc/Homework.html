<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Feihong Yu" />

<meta name="date" content="2023-12-10" />

<title>Homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">Feihong Yu</h4>
<h4 class="date">2023-12-10</h4>



<div id="homework" class="section level2">
<h2>Homework</h2>
<div id="模拟带漂移的随机游走" class="section level3">
<h3>模拟带漂移的随机游走</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">## 生成时间序列数据</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">1000</span>,<span class="dv">1</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">1000</span>,<span class="dv">1</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){   </span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>X[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> X[i]<span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>}</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){   </span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>Y[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> Y[i]<span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">1</span>)<span class="sc">+</span><span class="fl">0.3</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>}</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="fu">plot</span>(X,<span class="at">col=</span><span class="dv">2</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="fu">lines</span>(Y,<span class="at">col=</span><span class="dv">3</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">pch=</span><span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">15</span>),<span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;δ=0&quot;</span>,<span class="st">&quot;δ=0.3&quot;</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
## hw1 ### Question 利用逆变换法实现 sample 的功能</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>my.sample <span class="ot">&lt;-</span> <span class="cf">function</span>(x,size,<span class="at">replace =</span><span class="cn">TRUE</span> ,<span class="at">prob=</span> <span class="cn">NULL</span>){</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  <span class="do">## 计算累计概率分布函数,记作cp</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>   x.size<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>   <span class="cf">if</span>(<span class="fu">is.null</span>(prob) )  cp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">/</span>x.size,<span class="dv">1</span>,<span class="at">length =</span>x.size))</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>    <span class="cf">else</span> cp<span class="ot">&lt;-</span> <span class="fu">cumsum</span>(prob)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>   <span class="do">## 使用逆变换法 </span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>    u<span class="ot">&lt;-</span><span class="fu">runif</span>(size)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>    i<span class="ot">&lt;-</span> <span class="fu">findInterval</span>(u,cp)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>    <span class="fu">return</span>( x[i<span class="sc">+</span><span class="dv">1</span>])</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>}</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="do">## 测试集</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">2023</span>)</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>    <span class="fu">my.sample</span>(letters,<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;m&quot; &quot;i&quot; &quot;e&quot; &quot;k&quot; &quot;a&quot; &quot;d&quot; &quot;l&quot; &quot;q&quot; &quot;g&quot; &quot;m&quot;</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>    <span class="fu">my.sample</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##  [1]  9  2  2 10  9  2  4  9  4  8</code></pre>
</div>
<div id="question" class="section level3">
<h3>Question</h3>
<p>The standard Laplace distribution has density <span class="math display">\[f(x) = (1/2) * e^{-|x|}, x \in R.\]</span> Use
the inverse transform method to generate a random sample of size 1000
from this distribution. Use one of the methods shown in this chapter to
compare the generated sample to the target distribution.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co">#定义抽样数</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>N<span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#抽样</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>U<span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="fu">library</span>(VGAM)</span></code></pre></div>
<pre><code>## Loading required package: stats4</code></pre>
<pre><code>## Loading required package: splines</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">qlaplace</span>(U)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co"># 结果包括积分上限的估计值</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">probability=</span> <span class="cn">TRUE</span> )</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(x),<span class="at">col=</span> <span class="st">&quot;blue&quot;</span>,<span class="at">main=</span><span class="st">&quot;density f(x)&quot;</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fl">0.5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(<span class="fu">abs</span>(x))) </span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>lap.density<span class="ot">&lt;-</span> <span class="fu">f</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>,<span class="dv">6</span>,<span class="at">length=</span>N))</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>,<span class="dv">6</span>,<span class="at">length=</span>N),lap.density,<span class="at">col=</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;simulated&quot;</span>,<span class="st">&quot;True &quot;</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>),<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>###　Question Write a function to generate a random sample of size n
from the Beta(a, b) distribution by the acceptance-rejection method.
Generate a random sample of size 1000 from the Beta(3,2) distribution.
Graph the histogram of the sample with the theoretical Beta(3,2) density
superimposed.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e4</span>;j<span class="ot">&lt;-</span>k<span class="ot">&lt;-</span><span class="dv">0</span>;y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>j <span class="ot">&lt;-</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="co">#random variate from g(.)</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="cf">if</span> (x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>x) <span class="sc">&gt;</span> u) {</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#we accept x</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>y[k] <span class="ot">&lt;-</span> x</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>}</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>}</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="fu">hist</span>(y,<span class="at">probability=</span> <span class="cn">TRUE</span> )</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>   <span class="dv">12</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x) </span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>lap.density<span class="ot">&lt;-</span> <span class="fu">g</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length=</span>n))</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length=</span>n),lap.density,<span class="at">col=</span> <span class="st">&quot;red&quot;</span>,<span class="at">main=</span><span class="st">&quot;density&quot;</span>)</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;density&quot;</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>),<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<hr />
</div>
<div id="question-1" class="section level3">
<h3>Question</h3>
<p>The [85] is a symmetric density function <span class="math display">\[f(x) = \frac{3}{4} \left(1 - x^2\right), \quad
|x| \leq 1\]</span> Devroye and Gyorfi [71, p. 236] give the following
algorithm for simulation from this distribution. Generate iid U1, U2, U3
∼ Uniform(−1, 1). If |U3| ≥ |U2| and |U3| ≥ |U1|, deliver U2; otherwise
deliver U3. Write a function to generate random variates from f, and
construct the histogram density estimate of a large simulated random
sample.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>N<span class="ot">&lt;-</span> <span class="dv">30000</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">runif</span>(N,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),<span class="at">nrow =</span> N<span class="sc">/</span><span class="dv">3</span>,<span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="at">length =</span> N<span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(N<span class="sc">/</span><span class="dv">3</span>)) {</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">abs</span>(u[i,<span class="dv">3</span>])<span class="sc">&gt;=</span><span class="fu">max</span>(<span class="fu">abs</span>(u[i,]))) x[i]<span class="ot">&lt;-</span> u[i,<span class="dv">2</span>]</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>  <span class="cf">else</span> x[i]<span class="ot">&lt;-</span> u[i,<span class="dv">3</span>]</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>}</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob=</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(x),<span class="at">col=</span> <span class="st">&quot;red&quot;</span>,<span class="at">main=</span><span class="st">&quot;density&quot;</span>)</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;density&quot;</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>),<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="hw2" class="section level2">
<h2>hw2</h2>
<div id="question-2" class="section level3">
<h3>1.Question</h3>
<p>Proof that what value <span class="math inline">\(\rho =
\dfrac{l}{d}\)</span> should take to minimize the asymptotic variance of
<span class="math inline">\(\hat{\pi}\)</span>?(<span class="math inline">\(m ∼ B(n, p)\)</span>,using <span class="math inline">\(\delta\)</span> method)</p>
<p>Sol: <span class="math display">\[\pi =
2\rho*\frac{n}{m}\]</span>,where m is a sum of iid random Bernoulli
variable.By the Central Limit Theorem,<span class="math display">\[\sqrt{n}\left(\frac{m}{n} - p \right) \sim
N(0,p(1-p)).\]</span> and we have <span class="math display">\[\sqrt{n}\left(\hat{\pi} - 2\rho/p \right) \sim
N(0,4\rho^2(1-p)/p^3).\]</span>It means that the asymptotic variance is
non-decreasing with regard to <span class="math inline">\(\rho\)</span>,so the best value for it is 1.</p>
<ul>
<li>Part 2 Simulation</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="do">## \rho =1 </span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1006</span>)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>pihat1<span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>pihat2<span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>pihat3<span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">runif</span>(N,<span class="dv">0</span>,d<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">runif</span>(N,<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>pihat1[i] <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>rho<span class="sc">/</span><span class="fu">mean</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>}</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">runif</span>(N,<span class="dv">0</span>,d<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">runif</span>(N,<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a>pihat2[i] <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>rho<span class="sc">/</span><span class="fu">mean</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)</span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a>}</span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.25</span></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">runif</span>(N,<span class="dv">0</span>,d<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">runif</span>(N,<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a>pihat3[i] <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>rho<span class="sc">/</span><span class="fu">mean</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)</span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a>}</span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a><span class="do">## output the variance respectively，rho 1,0.5,0.25.</span></span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a><span class="fu">var</span>(pihat1)</span></code></pre></div>
<pre><code>## [1] 5.991077e-06</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">var</span>(pihat2)</span></code></pre></div>
<pre><code>## [1] 1.27764e-06</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">var</span>(pihat3)</span></code></pre></div>
<pre><code>## [1] 2.918095e-07</code></pre>
</div>
<div id="question-3" class="section level3">
<h3>2.Question</h3>
<p>5.6 In Example 5.7 the control variate approach was illustrated for
Monte Carlo integration of <span class="math display">\[
\theta=\int_0^1 e^x d x .
\]</span> Now consider the antithetic variate approach. Compute <span class="math inline">\(\operatorname{Cov}\left(e^U,
e^{1-U}\right)\)</span> and <span class="math inline">\(\operatorname{Var}\left(e^U+e^{1-U}\right)\)</span>,
where <span class="math inline">\(U \sim
\operatorname{Uniform}(0,1)\)</span>. What is the percent reduction in
variance of <span class="math inline">\(\hat{\theta}\)</span> that can
be achieved using antithetic variates (compared with simple MC)?</p>
<p>5.7 Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate
<span class="math inline">\(\theta\)</span> by the antithetic variate
approach and by the simple Monte Carlo method. Compute an empirical
estimate of the percent reduction in variance using the antithetic
variate. Compare the result with the theoretical value from Exercise
5.6.</p>
<p>Sol: - Part one:<span class="math inline">\(Cov(e^U,e^{1-U}=\int_0^1
e^{x(1-x)} dx - (e-1)^2 =-1.7679\)</span>,and <span class="math inline">\(Var(e^U+e^{1-U})=2Var(e^U)+2Cov(e^U,e^{1-U})=2.8533,Var(e^U)=
3.1945\)</span> ,so the percent reduction is
(3.1945-2.8533/2)/3.1945=55.34%.</p>
<ul>
<li>Part two: Simulation</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>thetamc<span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>thetaant <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1006</span>)</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="cf">for</span> ( i  <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>  u<span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>  v<span class="ot">&lt;-</span> u[<span class="dv">1</span><span class="sc">:</span>(N<span class="sc">/</span><span class="dv">2</span>)]</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>  thetamc[i]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span>N<span class="sc">*</span><span class="fu">mean</span>(<span class="fu">exp</span>(u))</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>  thetaant[i]<span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">/</span>N <span class="sc">*</span> <span class="fu">mean</span>(<span class="fu">exp</span>(v)<span class="sc">+</span><span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>v))</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>}</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a> <span class="dv">1</span><span class="sc">-</span><span class="fu">var</span>(thetaant)<span class="sc">/</span><span class="fu">var</span>(thetamc)</span></code></pre></div>
<pre><code>## [1] 0.5779708</code></pre>
<p>The outcome is approximate to the theoretic result.</p>
</div>
</div>
<div id="hw3" class="section level2">
<h2>hw3</h2>
<div id="question-4" class="section level3">
<h3>Question</h3>
<p>(5.13) Find two importance functions f1 and f2 that are supported on
(1, ∞) and are ‘close’ to <span class="math inline">\(g(x) =
\frac{x^2}{\sqrt{2\pi}}e^{−x^2/2}, x &gt; 1\)</span>. Which of your two
importance functions should produce the smaller variance in estimating
<span class="math inline">\(\int_1^\infty
\frac{x^2}{\sqrt{2\pi}}e^{−x^2/2}dx\)</span> by importance sampling?
Explain.?</p>
<p>It’s obvious that the function <span class="math inline">\(g(x)\)</span> is close to the probability density
function of the standard normal distribution. Therefore, we can define
<span class="math inline">\(f_1(x)\)</span> as follows <span class="math display">\[f_1(x)=\frac{1}{\sqrt{2\pi}} e^{−x^2/2}.\]</span>
Additionally, we can use the probability density function of Gamma
distributions for <span class="math inline">\(f_2\)</span>. The density
function of a <span class="math inline">\(Gamma(3,2)\)</span>
distribution is given by: <span class="math display">\[f_2(x)=\frac{1}{16}x^2e^{-x/2}I_{(0,\infty)}(x).\]</span></p>
<ul>
<li>Here are two figures illustrating the functions <span class="math inline">\(g, f_1, f_2\)</span>.</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20231015</span>)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span>(x<span class="sc">&gt;=</span><span class="dv">1</span>)</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>}</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">8</span>,<span class="fl">0.01</span>)</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>gs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">g</span>(x)),<span class="fu">expression</span>(<span class="fu">f1</span>(x)),<span class="fu">expression</span>(<span class="fu">f2</span>(x)))</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="co"># figure of g, f1, f2</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">g</span>(x), <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.7</span>), <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col=</span><span class="dv">1</span>)</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">dnorm</span>(x), <span class="at">lwd=</span><span class="dv">1</span>, <span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">dgamma</span>(x,<span class="dv">3</span>,<span class="dv">2</span>), <span class="at">lwd=</span><span class="dv">1</span>, <span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> gs, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">1</span>, <span class="at">inset =</span> <span class="fl">0.02</span>,<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a><span class="co"># figure of g/f1, g/f2</span></span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">dnorm</span>(x), <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>), <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">dgamma</span>(x,<span class="dv">3</span>,<span class="dv">2</span>), <span class="at">lwd=</span><span class="dv">1</span>, <span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> gs[<span class="sc">-</span><span class="dv">1</span>], <span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">1</span>, <span class="at">inset =</span> <span class="fl">0.02</span>,<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the figures, we can conclude that <span class="math inline">\(f_2\)</span> should offer a more acccurate
estimation, as the ratio <span class="math inline">\(g/f_2\)</span>
appears closer to a constant comparing with <span class="math inline">\(g/f_1\)</span>, which is a quadratic function.
Moreover, <span class="math inline">\(f_1\)</span> covers a broader
range, and many simulated values would contribute zeros to the sum,
resulting in inefficiency.</p>
<p>Now, let’s proceed with a simulation:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20231015</span>)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>m <span class="ot">=</span> <span class="fl">1e4</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>theta <span class="ot">&lt;-</span> se <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="co"># using f1</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m) </span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> <span class="fu">dnorm</span>(x)</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>theta[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>se[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="co"># using f2</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(m,<span class="dv">3</span>,<span class="dv">2</span>) </span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> <span class="fu">dgamma</span>(x,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>theta[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a>se[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a><span class="fu">rbind</span>(theta, se)</span></code></pre></div>
<pre><code>##            [,1]      [,2]
## theta 0.4022867 0.3928710
## se    1.1202321 0.3041682</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>se<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 1.25492000 0.09251827</code></pre>
<p>After conducting the simulation, we can affirm that <span class="math inline">\(f_2\)</span> offers a superior estimation of <span class="math inline">\(\theta\)</span></p>
</div>
<div id="question-5" class="section level3">
<h3>Question</h3>
<p>(5,14) Obtain a Monte Carlo estimate of <span class="math inline">\(\int_1^\infty
\frac{x^2}{\sqrt{2\pi}}e^{−x^2/2}dx\)</span> by importance sampling. The
mass function of the original Gamma distribution is <span class="math display">\[f(x | \alpha, \beta) =
\frac{\beta^\alpha}{\Gamma(\alpha)} x^{\alpha - 1} e^{-\beta x}, \quad x
&gt; 0\]</span> we need to change it into <span class="math display">\[f(x | \alpha&#39;, \beta&#39;) =
\frac{\beta&#39;^{\alpha&#39;}}{\Gamma(\alpha&#39;)} (x-1)^{\alpha&#39;
- 1} e^{-\beta&#39; (x-1)}, \quad x &gt; 1\]</span> <span class="math inline">\(α\)</span> and <span class="math inline">\(β\)</span> are the original shape and scale
parameters, while <span class="math inline">\(α&#39;\)</span> and <span class="math inline">\(β&#39;\)</span> are the redefined shape and scale
parameters, to make the distribution applicable within the interval
<span class="math inline">\((1, ∞)\)</span>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">3</span>  </span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">1</span>   </span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="co"># Number of samples</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>sample <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N, <span class="at">shape =</span> alpha, <span class="at">rate =</span> beta)</span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>est <span class="ot">&lt;-</span> (<span class="fu">mean</span>((sample<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">gamma</span>(alpha)) <span class="sc">/</span> beta<span class="sc">^</span>alpha))</span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a><span class="co"># Print the estimate</span></span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Monte Carlo Estimate:&quot;</span>, est, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Monte Carlo Estimate: 24.07865</code></pre>
</div>
<div id="question-6" class="section level3">
<h3>Question</h3>
<p>(5.15) Obtain the stratified importance sampling estimate in Example
5.13 and compare it with the result of Example 5.10. + Example 5.10</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20231015</span>)</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>estimation <span class="ot">&lt;-</span> sd <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="sc">-</span>x <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">*</span> (x <span class="sc">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>}</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m) <span class="co">#f3, inverse transform method</span></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> u <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> (<span class="fu">exp</span>(<span class="sc">-</span>x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>estimation <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span></code></pre></div>
<ul>
<li>Example 5.13</li>
</ul>
<p>Let <span class="math inline">\(f(x)=\frac{e^{-x}}{1-e^{-1}}\)</span>, <span class="math inline">\(F(x)=\int f(x)=\frac{1-e^{-x}}{1-e^{-1}}\)</span>.
Then <span class="math inline">\(F^{-1}(x)=-log[1-(1-e^{-1})x)]\)</span>. We divide
the real line into <span class="math inline">\(k=5\)</span> intervals
<span class="math inline">\(I_j=\{x:a_{j-1}\leq x&lt;a_j\}\)</span> and
<span class="math inline">\(a_j=F^{-1}(\frac{j}{k}),j=1,\dots,k\)</span>. On
each subinterval, the conditional density <span class="math inline">\(f_j\)</span> of <span class="math inline">\(X\)</span> is <span class="math display">\[f_j(x)=f_{X|I_j}(x|I_j)=\frac{f(x,a_{j-1}\leq
x&lt;a_j)}{P(a_{j-1}\leq x&lt;a_j)}=kf(x),\quad a_{j-1}\leq
x&lt;a_j.\]</span></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">5</span> </span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> M<span class="sc">/</span>k <span class="co"># replicates per stratum</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>T1 <span class="ot">&lt;-</span> T2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>estimation_2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>fj <span class="ot">&lt;-</span> <span class="cf">function</span>(x)<span class="dv">5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)) <span class="co"># fj(x)</span></span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x)<span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<p>For each subinterval <span class="math inline">\(I_j\)</span>, we use
inverse transform method to generate samples from <span class="math inline">\(f_j(x)\)</span>. Since <span class="math display">\[\begin{aligned}
F_j(x)
&amp;=\int_{a_{j-1}}^{x}f_j(x)dx\\
&amp;=5F(x)-5F(a_{j-1})\\
&amp;=5(F(x)-j+1),
\end{aligned}\]</span> we have <span class="math inline">\(F^{-1}_j(x)=-log[1-(1-e^{-1})(x+j-1)]\)</span>.<br />
Let <span class="math inline">\(\sigma_j^2=Var(g_j(X)/f_j(X))\)</span>.
For each <span class="math inline">\(j = 1,...,k\)</span>, we simulate
an importance sample size <span class="math inline">\(m\)</span>,
compute the importance sampling estimator <span class="math inline">\(\hat\theta_j\)</span> of <span class="math inline">\(\theta_j\)</span> on the <span class="math inline">\(j^{th}\)</span> subinterval, and compute <span class="math inline">\(\displaystyle\hat\theta^{SI}=\sum_{j=1}^k{\hat\theta_j}\)</span>.Then
by independence of <span class="math inline">\(\hat\theta_1,...,
\hat\theta_k\)</span>, <span class="math display">\[\displaystyle
Var(\hat\theta^{SI})=Var(\sum_{j=1}^k{\hat\theta_j})=\sum_{j=1}^k{\frac{\sigma_j^2}{m}}=\frac{1}{m}\sum_{j=1}^k{\sigma_j^2}.\]</span></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20231015</span>)</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">runif</span>(m)</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>  x <span class="ot">=</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>(u<span class="sc">+</span>j<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">5</span>) <span class="co"># inverse transform method</span></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>  T1[j] <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">fj</span>(x))</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>  T2[j] <span class="ot">=</span> <span class="fu">var</span>(<span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">fj</span>(x))</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>}</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>estimation_2[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">sum</span>(T1) </span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>estimation_2[<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">sum</span>(T2)</span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(estimation,estimation_2[<span class="dv">1</span>]),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.5250 0.5249</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(sd,<span class="fu">sqrt</span>(estimation_2[<span class="dv">2</span>])),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.09674 0.00938</code></pre>
<p>From the results, it’s oblivious that the stratified importance
sampling estimate is better because its variance is much smaller than
the result of Example 5.10.</p>
</div>
<div id="question-7" class="section level3">
<h3>Question</h3>
<p>(6.5) Suppose a 95% symmetric t-interval is applied to estimate a
mean, but the sample data are non-normal. Then the probability that the
confidence interval covers the mean is not necessarily equal to 0.95.
Use a Monte Carlo experiment to estimate the coverage probability of the
t-interval for random samples of <span class="math inline">\(χ^2(2)\)</span> data with sample size n = 20.
Compare your t-interval results with the simulation results in Example
6.4. (The t-interval should be more robust to departures from normality
than the interval for variance.)</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fl">0.95</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>true_mean <span class="ot">&lt;-</span> <span class="dv">2</span>  </span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>suc_intervals <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(s, <span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>  </span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a>  sample_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a>  sample_sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a>  </span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a>  moe <span class="ot">&lt;-</span> <span class="fu">qt</span>((<span class="dv">1</span> <span class="sc">+</span> cl) <span class="sc">/</span> <span class="dv">2</span>, <span class="at">df =</span> s <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (sample_sd <span class="sc">/</span> <span class="fu">sqrt</span>(s))</span>
<span id="cb34-15"><a href="#cb34-15" tabindex="-1"></a>  interval <span class="ot">&lt;-</span> <span class="fu">c</span>(sample_mean <span class="sc">-</span> moe, sample_mean <span class="sc">+</span> moe)</span>
<span id="cb34-16"><a href="#cb34-16" tabindex="-1"></a>  </span>
<span id="cb34-17"><a href="#cb34-17" tabindex="-1"></a>  <span class="cf">if</span> (true_mean <span class="sc">&gt;=</span> interval[<span class="dv">1</span>] <span class="sc">&amp;&amp;</span> true_mean <span class="sc">&lt;=</span> interval[<span class="dv">2</span>]) {</span>
<span id="cb34-18"><a href="#cb34-18" tabindex="-1"></a>    suc_intervals <span class="ot">&lt;-</span> suc_intervals <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb34-19"><a href="#cb34-19" tabindex="-1"></a>  }</span>
<span id="cb34-20"><a href="#cb34-20" tabindex="-1"></a>}</span>
<span id="cb34-21"><a href="#cb34-21" tabindex="-1"></a></span>
<span id="cb34-22"><a href="#cb34-22" tabindex="-1"></a>c_p <span class="ot">&lt;-</span> suc_intervals <span class="sc">/</span> n</span>
<span id="cb34-23"><a href="#cb34-23" tabindex="-1"></a></span>
<span id="cb34-24"><a href="#cb34-24" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated Coverage Probability:&quot;</span>, c_p, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Estimated Coverage Probability: 0.9175</code></pre>
<p>The t-interval should be more robust to departures from normality
than the interval for variance.</p>
</div>
</div>
<div id="question-8" class="section level2">
<h2>Question</h2>
<p>(6.A) Use Monte Carlo simulation to investigate whether the empirical
Type I error rate of the t-test is approximately equal to the nominal
significance level <span class="math inline">\(α\)</span>, when the
sampled population is non-normal. The t-test is robust to mild
departures from normality. Discuss the simulation results for the cases
where the sampled population is (i) <span class="math inline">\(χ^2(1)\)</span>, (ii) Uniform(0,2), and (iii)
Exponential(rate=1). In each case, test <span class="math inline">\(H_0
: µ = µ_0 ~vs~ H_0 : µ \µ0_,\)</span> where µ0 is the mean of <span class="math inline">\(χ^2(1)\)</span>, Uniform(0,2), and Exponential(1),
respectively.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>true_mean_chi_sq <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>true_mean_uniform <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>true_mean_exponential <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a>rej_chi_sq <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a>rej_uniform <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a>rej_exponential <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a><span class="co"># Perform Monte Carlo simulations for each case</span></span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a>  </span>
<span id="cb36-15"><a href="#cb36-15" tabindex="-1"></a>  sample_chi_sq <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">30</span>, <span class="at">df =</span> <span class="dv">1</span>)  </span>
<span id="cb36-16"><a href="#cb36-16" tabindex="-1"></a>  sample_uniform <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">30</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">2</span>) </span>
<span id="cb36-17"><a href="#cb36-17" tabindex="-1"></a>  sample_exponential <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">30</span>, <span class="at">rate =</span> <span class="dv">1</span>)  </span>
<span id="cb36-18"><a href="#cb36-18" tabindex="-1"></a>  </span>
<span id="cb36-19"><a href="#cb36-19" tabindex="-1"></a>  t_test_chi_sq <span class="ot">&lt;-</span> <span class="fu">t.test</span>(sample_chi_sq, <span class="at">mu =</span> true_mean_chi_sq, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb36-20"><a href="#cb36-20" tabindex="-1"></a>  t_test_uniform <span class="ot">&lt;-</span> <span class="fu">t.test</span>(sample_uniform, <span class="at">mu =</span> true_mean_uniform, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb36-21"><a href="#cb36-21" tabindex="-1"></a>  t_test_exponential <span class="ot">&lt;-</span> <span class="fu">t.test</span>(sample_exponential, <span class="at">mu =</span> true_mean_exponential, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb36-22"><a href="#cb36-22" tabindex="-1"></a>  </span>
<span id="cb36-23"><a href="#cb36-23" tabindex="-1"></a>  <span class="cf">if</span> (t_test_chi_sq<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha) {</span>
<span id="cb36-24"><a href="#cb36-24" tabindex="-1"></a>    rej_chi_sq <span class="ot">&lt;-</span> rej_chi_sq <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb36-25"><a href="#cb36-25" tabindex="-1"></a>  }</span>
<span id="cb36-26"><a href="#cb36-26" tabindex="-1"></a>  </span>
<span id="cb36-27"><a href="#cb36-27" tabindex="-1"></a>  <span class="cf">if</span> (t_test_uniform<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha) {</span>
<span id="cb36-28"><a href="#cb36-28" tabindex="-1"></a>    rej_uniform <span class="ot">&lt;-</span> rej_uniform <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb36-29"><a href="#cb36-29" tabindex="-1"></a>  }</span>
<span id="cb36-30"><a href="#cb36-30" tabindex="-1"></a>  </span>
<span id="cb36-31"><a href="#cb36-31" tabindex="-1"></a>  <span class="cf">if</span> (t_test_exponential<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha) {</span>
<span id="cb36-32"><a href="#cb36-32" tabindex="-1"></a>    rej_exponential <span class="ot">&lt;-</span> rej_exponential <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb36-33"><a href="#cb36-33" tabindex="-1"></a>  }</span>
<span id="cb36-34"><a href="#cb36-34" tabindex="-1"></a>}</span>
<span id="cb36-35"><a href="#cb36-35" tabindex="-1"></a></span>
<span id="cb36-36"><a href="#cb36-36" tabindex="-1"></a>t1e_chi_sq <span class="ot">&lt;-</span> rej_chi_sq <span class="sc">/</span> n</span>
<span id="cb36-37"><a href="#cb36-37" tabindex="-1"></a>t1e_uniform <span class="ot">&lt;-</span> rej_uniform <span class="sc">/</span> n</span>
<span id="cb36-38"><a href="#cb36-38" tabindex="-1"></a>t1e_exponential <span class="ot">&lt;-</span> rej_exponential <span class="sc">/</span> n</span>
<span id="cb36-39"><a href="#cb36-39" tabindex="-1"></a></span>
<span id="cb36-40"><a href="#cb36-40" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb36-41"><a href="#cb36-41" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Type I Error Rate for χ²(1) Data:&quot;</span>, t1e_chi_sq, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Type I Error Rate for χ²(1) Data: 0.0932</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Type I Error Rate for Uniform(0,2) Data:&quot;</span>, t1e_uniform, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Type I Error Rate for Uniform(0,2) Data: 0.0506</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Type I Error Rate for Exponential(1) Data:&quot;</span>, t1e_exponential, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Type I Error Rate for Exponential(1) Data: 0.0705</code></pre>
</div>
<div id="hw4" class="section level2">
<h2>hw4</h2>
<div id="question-9" class="section level3">
<h3>Question</h3>
<ul>
<li>Suppose the population has the exponential distribution with rate
<span class="math inline">\(\lambda\)</span>, then the MLE of <span class="math inline">\(\lambda\)</span> is <span class="math inline">\(\hat\lambda=1/\bar X\)</span>, where <span class="math inline">\(\bar X\)</span> is the sample mean. It can be
derived that the expectation of <span class="math inline">\(\hat\lambda\)</span> is <span class="math inline">\(\lambda n/(n-1)\)</span>, so that the estimation
bias is <span class="math inline">\(\lambda/(n-1)\)</span>. The standard
error <span class="math inline">\(\hat\lambda\)</span> is <span class="math inline">\(\lambda n/[(n-1)\sqrt{n-2}]\)</span>. Conduct a
simulation study to verify the performance of the bootstrap method.
<ul>
<li>The true value of <span class="math inline">\(\lambda=2\)</span>.</li>
<li>The sample size <span class="math inline">\(n=5,10,20\)</span>.</li>
<li>The number of bootstrap replicates <span class="math inline">\(B =
1000\)</span>.</li>
<li>The simulations are repeated for <span class="math inline">\(m=1000\)</span> times.</li>
<li>Compare the mean bootstrap bias and bootstrap standard error with
the theoretical ones. Comment on the results.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>   <span class="fu">set.seed</span>(<span class="dv">20231022</span>)</span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a>    <span class="fu">library</span>(boot); <span class="fu">library</span>(MASS)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;boot&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:VGAM&#39;:
## 
##     logit, simplex</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>    lambda <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x[i])</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n,<span class="dv">2</span>)</span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>    obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>x,<span class="at">statistic=</span>lambda,<span class="at">R=</span><span class="fl">1e4</span>)</span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>obj<span class="sc">$</span>t0,<span class="at">bias=</span><span class="fu">mean</span>(obj<span class="sc">$</span>t)<span class="sc">-</span>obj<span class="sc">$</span>t0,</span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a>            <span class="at">se=</span><span class="fu">sd</span>(obj<span class="sc">$</span>t)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## original     bias       se 
##    1.731    0.066    0.348</code></pre>
<p>Theoretically,the bia and se are 0.10，0.496.</p>
<p>n=10</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n,<span class="dv">2</span>)</span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a>    obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>x,<span class="at">statistic=</span>lambda,<span class="at">R=</span><span class="fl">1e4</span>)</span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>obj<span class="sc">$</span>t0,<span class="at">bias=</span><span class="fu">mean</span>(obj<span class="sc">$</span>t)<span class="sc">-</span>obj<span class="sc">$</span>t0,</span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a>            <span class="at">se=</span><span class="fu">sd</span>(obj<span class="sc">$</span>t)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## original     bias       se 
##    2.017    0.107    0.505</code></pre>
<p>Theoretically,the bias and se are 0.22，0.786.</p>
<p>n=5</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n,<span class="dv">2</span>)</span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a>    obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>x,<span class="at">statistic=</span>lambda,<span class="at">R=</span><span class="fl">1e4</span>)</span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>obj<span class="sc">$</span>t0,<span class="at">bias=</span><span class="fu">mean</span>(obj<span class="sc">$</span>t)<span class="sc">-</span>obj<span class="sc">$</span>t0,</span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>            <span class="at">se=</span><span class="fu">sd</span>(obj<span class="sc">$</span>t)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## original     bias       se 
##    3.202    0.839    2.593</code></pre>
<p>Theoretically,the bia and se are 0.50，1.44.</p>
<p>###Question Obtain a bootstrap t confidence interval estimate for the
correlation statistic in Example 7.2 (law data in bootstrap)</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;bootstrap&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:VGAM&#39;:
## 
##     hormone</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a>law1<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(law)</span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a>boot.t.ci <span class="ot">&lt;-</span></span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a><span class="cf">function</span>(x, <span class="at">B =</span> <span class="dv">500</span>, <span class="at">R =</span> <span class="dv">100</span>, <span class="at">level =</span> .<span class="dv">95</span>, statistic){</span>
<span id="cb54-6"><a href="#cb54-6" tabindex="-1"></a><span class="co">#compute the bootstrap t CI</span></span>
<span id="cb54-7"><a href="#cb54-7" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(x); n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb54-8"><a href="#cb54-8" tabindex="-1"></a>stat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B); se <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb54-9"><a href="#cb54-9" tabindex="-1"></a>boot.se <span class="ot">&lt;-</span> <span class="cf">function</span>(x, R, f) {</span>
<span id="cb54-10"><a href="#cb54-10" tabindex="-1"></a><span class="co">#local function to compute the bootstrap</span></span>
<span id="cb54-11"><a href="#cb54-11" tabindex="-1"></a><span class="co">#estimate of standard error for statistic f(x)</span></span>
<span id="cb54-12"><a href="#cb54-12" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(x); m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb54-13"><a href="#cb54-13" tabindex="-1"></a>th <span class="ot">&lt;-</span> <span class="fu">replicate</span>(R, <span class="at">expr =</span> {</span>
<span id="cb54-14"><a href="#cb54-14" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>m, <span class="at">size =</span> m, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-15"><a href="#cb54-15" tabindex="-1"></a><span class="fu">f</span>(x[i, ])</span>
<span id="cb54-16"><a href="#cb54-16" tabindex="-1"></a>})</span>
<span id="cb54-17"><a href="#cb54-17" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">sd</span>(th))</span>
<span id="cb54-18"><a href="#cb54-18" tabindex="-1"></a>}</span>
<span id="cb54-19"><a href="#cb54-19" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb54-20"><a href="#cb54-20" tabindex="-1"></a>j <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-21"><a href="#cb54-21" tabindex="-1"></a>y <span class="ot">&lt;-</span> x[j, ]</span>
<span id="cb54-22"><a href="#cb54-22" tabindex="-1"></a>stat[b] <span class="ot">&lt;-</span> <span class="fu">statistic</span>(y)</span>
<span id="cb54-23"><a href="#cb54-23" tabindex="-1"></a>se[b] <span class="ot">&lt;-</span> <span class="fu">boot.se</span>(y, <span class="at">R =</span> R, <span class="at">f =</span> statistic)</span>
<span id="cb54-24"><a href="#cb54-24" tabindex="-1"></a>}</span>
<span id="cb54-25"><a href="#cb54-25" tabindex="-1"></a>stat0 <span class="ot">&lt;-</span> <span class="fu">statistic</span>(x)</span>
<span id="cb54-26"><a href="#cb54-26" tabindex="-1"></a>t.stats <span class="ot">&lt;-</span> (stat <span class="sc">-</span> stat0) <span class="sc">/</span> se</span>
<span id="cb54-27"><a href="#cb54-27" tabindex="-1"></a>se0 <span class="ot">&lt;-</span> <span class="fu">sd</span>(stat)</span>
<span id="cb54-28"><a href="#cb54-28" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> level</span>
<span id="cb54-29"><a href="#cb54-29" tabindex="-1"></a>Qt <span class="ot">&lt;-</span> <span class="fu">quantile</span>(t.stats, <span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>), <span class="at">type =</span> <span class="dv">1</span>)</span>
<span id="cb54-30"><a href="#cb54-30" tabindex="-1"></a><span class="fu">names</span>(Qt) <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">names</span>(Qt))</span>
<span id="cb54-31"><a href="#cb54-31" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="fu">rev</span>(stat0 <span class="sc">-</span> Qt <span class="sc">*</span> se0)</span>
<span id="cb54-32"><a href="#cb54-32" tabindex="-1"></a>}</span>
<span id="cb54-33"><a href="#cb54-33" tabindex="-1"></a></span>
<span id="cb54-34"><a href="#cb54-34" tabindex="-1"></a>b.cor <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) <span class="fu">cor</span>(x[i,<span class="dv">1</span>],x[i,<span class="dv">2</span>])</span>
<span id="cb54-35"><a href="#cb54-35" tabindex="-1"></a></span>
<span id="cb54-36"><a href="#cb54-36" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">boot.t.ci</span>(law1, <span class="at">statistic =</span> b.cor, <span class="at">B=</span><span class="dv">2000</span>, <span class="at">R=</span><span class="dv">200</span>)</span>
<span id="cb54-37"><a href="#cb54-37" tabindex="-1"></a><span class="fu">print</span>(ci)</span></code></pre></div>
<pre><code>##       2.5%      97.5% 
## -0.2139617  0.9777151</code></pre>
</div>
</div>
<div id="hw5" class="section level2">
<h2>hw5</h2>
<div id="question-10" class="section level3">
<h3>Question</h3>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures 1/λ by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p>
<p>Sol:From Ex 7.4 ,Let <span class="math inline">\(\vec{X}\in
\mathbb{R}^n\)</span> be sample, we obtain the loglikelihood <span class="math display">\[
l(\lambda|x)=\lambda^ne^{-\lambda \sum x_i} \]</span> Compute the
maxmimizer and get <span class="math inline">\(\hat{\lambda}_{MLE} =
\frac{1}{\bar{X}}\)</span> so the estimator for <span class="math inline">\(\hat{\frac{1}{\lambda}}=\bar{X}\)</span>. Below we
show in Rlab how to compute the confidence intervals</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a>m<span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20231028</span>)</span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a>b.mean<span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) <span class="fu">mean</span>(x[i])</span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a>data<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(aircondit) </span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a>ci.norm<span class="ot">&lt;-</span>ci.basic<span class="ot">&lt;-</span>ci.perc<span class="ot">&lt;-</span>ci.bca<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a></span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a>  bootout<span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span> data,<span class="at">statistic =</span> b.mean ,<span class="at">R =</span><span class="dv">1000</span>)</span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bootout,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a>  <span class="fu">print</span>(ci)</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = bootout, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 35.2, 182.0 )   ( 26.9, 169.7 )  
## 
## Level     Percentile            BCa          
## 95%   ( 46.4, 189.2 )   ( 58.8, 231.4 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<p>The intervals are different because they apply different assumptions
to the bootstrap resamples.</p>
</div>
<div id="question-11" class="section level3">
<h3>Question</h3>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat{\theta}\)</span></p>
<p>Sol: Note that the sample covariance matrix is symmetric ,so the sum
of eigenvalue equals to the trace of the matrix.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">nrow</span>(scor)</span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a>Cov<span class="ot">&lt;-</span><span class="fu">cov</span>(scor)</span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>theta<span class="ot">=</span><span class="fu">max</span>(<span class="fu">eigen</span>(Cov)<span class="sc">$</span>values)<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">diag</span>(Cov))</span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a>thetajack<span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a>  cov<span class="ot">&lt;-</span> <span class="fu">cov</span>(scor[<span class="sc">-</span>i,])</span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a>  sum<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">diag</span>(cov))</span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a>  thetajack[i]<span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">eigen</span>(cov)<span class="sc">$</span>values)<span class="sc">/</span>sum</span>
<span id="cb58-10"><a href="#cb58-10" tabindex="-1"></a>}</span>
<span id="cb58-11"><a href="#cb58-11" tabindex="-1"></a>jackmean<span class="ot">&lt;-</span> <span class="fu">mean</span>(thetajack)</span>
<span id="cb58-12"><a href="#cb58-12" tabindex="-1"></a>bias <span class="ot">&lt;-</span> (m<span class="dv">-1</span>)<span class="sc">*</span>(jackmean<span class="sc">-</span>theta)</span>
<span id="cb58-13"><a href="#cb58-13" tabindex="-1"></a>variance<span class="ot">&lt;-</span> m<span class="sc">/</span>(m<span class="dv">-1</span>)<span class="sc">*</span> <span class="fu">sum</span>((thetajack<span class="sc">-</span>jackmean)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb58-14"><a href="#cb58-14" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(bias,variance))</span></code></pre></div>
<pre><code>## [1] 0.001069139 0.002512202</code></pre>
</div>
<div id="question-12" class="section level3">
<h3>Question</h3>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to
select the best fitting model. Use leave-two-out cross validation to
compare the models.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)</span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a><span class="co">#in DAAG ironslag</span></span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> n<span class="sc">*</span>(n<span class="dv">-1</span>),<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a><span class="co"># for n-fold cross validation</span></span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a><span class="co"># fit models on leave-two-out samples</span></span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)) {</span>
<span id="cb63-8"><a href="#cb63-8" tabindex="-1"></a>  <span class="cf">for</span> (l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)) {</span>
<span id="cb63-9"><a href="#cb63-9" tabindex="-1"></a>    </span>
<span id="cb63-10"><a href="#cb63-10" tabindex="-1"></a>  </span>
<span id="cb63-11"><a href="#cb63-11" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb63-12"><a href="#cb63-12" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb63-13"><a href="#cb63-13" tabindex="-1"></a>y <span class="ot">&lt;-</span> y1[<span class="sc">-</span>l]</span>
<span id="cb63-14"><a href="#cb63-14" tabindex="-1"></a>x <span class="ot">&lt;-</span> x1[<span class="sc">-</span>l]</span>
<span id="cb63-15"><a href="#cb63-15" tabindex="-1"></a>J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb63-16"><a href="#cb63-16" tabindex="-1"></a>yhat11 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb63-17"><a href="#cb63-17" tabindex="-1"></a>yhat12 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> x1[l]</span>
<span id="cb63-18"><a href="#cb63-18" tabindex="-1"></a>e1[(k<span class="dv">-1</span>)<span class="sc">*</span>n<span class="sc">+</span>l,<span class="dv">1</span>] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat11</span>
<span id="cb63-19"><a href="#cb63-19" tabindex="-1"></a>e1[(k<span class="dv">-1</span>)<span class="sc">*</span>n<span class="sc">+</span>l,<span class="dv">2</span>] <span class="ot">&lt;-</span> y1[l] <span class="sc">-</span> yhat12</span>
<span id="cb63-20"><a href="#cb63-20" tabindex="-1"></a>J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb63-21"><a href="#cb63-21" tabindex="-1"></a>yhat21 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span></span>
<span id="cb63-22"><a href="#cb63-22" tabindex="-1"></a>J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb63-23"><a href="#cb63-23" tabindex="-1"></a>yhat22 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> x1[l] <span class="sc">+</span></span>
<span id="cb63-24"><a href="#cb63-24" tabindex="-1"></a>J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> x1[l]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb63-25"><a href="#cb63-25" tabindex="-1"></a>e2[(k<span class="dv">-1</span>)<span class="sc">*</span>n<span class="sc">+</span>l,<span class="dv">1</span>] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat21</span>
<span id="cb63-26"><a href="#cb63-26" tabindex="-1"></a>e2[(k<span class="dv">-1</span>)<span class="sc">*</span>n<span class="sc">+</span>l,<span class="dv">2</span>] <span class="ot">&lt;-</span> y1[l] <span class="sc">-</span> yhat22</span>
<span id="cb63-27"><a href="#cb63-27" tabindex="-1"></a></span>
<span id="cb63-28"><a href="#cb63-28" tabindex="-1"></a>J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb63-29"><a href="#cb63-29" tabindex="-1"></a>logyhat31 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb63-30"><a href="#cb63-30" tabindex="-1"></a>logyhat32 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> x1[l]</span>
<span id="cb63-31"><a href="#cb63-31" tabindex="-1"></a>yhat31 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat31)</span>
<span id="cb63-32"><a href="#cb63-32" tabindex="-1"></a>yhat32 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat32)</span>
<span id="cb63-33"><a href="#cb63-33" tabindex="-1"></a>e3[(k<span class="dv">-1</span>)<span class="sc">*</span>n<span class="sc">+</span>l,<span class="dv">1</span>] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat31</span>
<span id="cb63-34"><a href="#cb63-34" tabindex="-1"></a>e3[(k<span class="dv">-1</span>)<span class="sc">*</span>n<span class="sc">+</span>l,<span class="dv">2</span>] <span class="ot">&lt;-</span> y1[l] <span class="sc">-</span> yhat32</span>
<span id="cb63-35"><a href="#cb63-35" tabindex="-1"></a></span>
<span id="cb63-36"><a href="#cb63-36" tabindex="-1"></a>J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb63-37"><a href="#cb63-37" tabindex="-1"></a>logyhat41 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[k])</span>
<span id="cb63-38"><a href="#cb63-38" tabindex="-1"></a>logyhat42 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(x1[l])</span>
<span id="cb63-39"><a href="#cb63-39" tabindex="-1"></a>yhat41 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat41)</span>
<span id="cb63-40"><a href="#cb63-40" tabindex="-1"></a>yhat42 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat42)</span>
<span id="cb63-41"><a href="#cb63-41" tabindex="-1"></a>e4[(k<span class="dv">-1</span>)<span class="sc">*</span>n<span class="sc">+</span>l,<span class="dv">1</span>] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat41</span>
<span id="cb63-42"><a href="#cb63-42" tabindex="-1"></a>e4[(k<span class="dv">-1</span>)<span class="sc">*</span>n<span class="sc">+</span>l,<span class="dv">2</span>] <span class="ot">&lt;-</span> y1[l] <span class="sc">-</span> yhat42</span>
<span id="cb63-43"><a href="#cb63-43" tabindex="-1"></a>}</span>
<span id="cb63-44"><a href="#cb63-44" tabindex="-1"></a>}</span>
<span id="cb63-45"><a href="#cb63-45" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(<span class="fu">colMeans</span>(e1<span class="sc">^</span><span class="dv">2</span>)), <span class="fu">mean</span>(<span class="fu">colMeans</span>(e2<span class="sc">^</span><span class="dv">2</span>)), <span class="fu">mean</span>(<span class="fu">colMeans</span>(e3<span class="sc">^</span><span class="dv">2</span>)), <span class="fu">mean</span>(<span class="fu">colMeans</span>(e4<span class="sc">^</span><span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## [1] 18.63850 16.84783 17.37527 19.35757</code></pre>
<p>According to the prediction error criterion, Model 2, the quadratic
model, would be the best fit for the data.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="fu">summary</span>( <span class="fu">lm</span>(magnetic<span class="sc">~</span> chemical<span class="sc">+</span><span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = magnetic ~ chemical + I(chemical^2))
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.4335 -2.7006 -0.2754  2.5446 12.2665 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)   24.49262    9.14657   2.678   0.0100 **
## chemical      -1.39334    0.88852  -1.568   0.1232   
## I(chemical^2)  0.05452    0.02081   2.620   0.0116 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.098 on 50 degrees of freedom
## Multiple R-squared:  0.5931, Adjusted R-squared:  0.5768 
## F-statistic: 36.44 on 2 and 50 DF,  p-value: 1.728e-10</code></pre>
</div>
</div>
<div id="hw6" class="section level2">
<h2>hw6</h2>
<div id="question-13" class="section level3">
<h3>Question</h3>
<p>Proof the Stationarity of Metropolis-Hastings sampler Algorithm in
continuous situation.</p>
<p>Sol:When <span class="math inline">\(s=r\)</span> the equation
holds.When <span class="math inline">\(s\neq r\)</span> <span class="math display">\[\begin{aligned}
K(r,s)f(r)= &amp; \alpha(r,s)g(s|r)f(r)\\
=&amp; \begin{cases}
f(r)g(s|r) &amp; ,f(r)g(s|r)\geq f(s)g(r|s)\\
f(s)g(r|s) &amp; ,f(r)g(s|r)&lt; f(s)g(r|s)
\end{cases}
\end{aligned}\]</span> From intuition of symmetry,it can be attested
that $K(s,r)f(s) $ has the same expression.</p>
</div>
<div id="question-14" class="section level3">
<h3>Question</h3>
<p>Implement the two-sample Cram´er-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</p>
<ul>
<li>Eg8.1</li>
</ul>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="fu">library</span>(CDFt)</span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb67-3"><a href="#cb67-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb67-4"><a href="#cb67-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb67-5"><a href="#cb67-5" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb67-6"><a href="#cb67-6" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span> <span class="co">#number of replicates</span></span>
<span id="cb67-7"><a href="#cb67-7" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y) <span class="co">#pooled sample</span></span>
<span id="cb67-8"><a href="#cb67-8" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">26</span></span>
<span id="cb67-9"><a href="#cb67-9" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R) <span class="co">#storage for replicates</span></span>
<span id="cb67-10"><a href="#cb67-10" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb67-11"><a href="#cb67-11" tabindex="-1"></a>D0 <span class="ot">&lt;-</span> <span class="fu">CramerVonMisesTwoSamples</span>(x, y)</span>
<span id="cb67-12"><a href="#cb67-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb67-13"><a href="#cb67-13" tabindex="-1"></a><span class="co">#generate indices k for the first sample</span></span>
<span id="cb67-14"><a href="#cb67-14" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb67-15"><a href="#cb67-15" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> z[k]</span>
<span id="cb67-16"><a href="#cb67-16" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k] <span class="co">#complement of x1</span></span>
<span id="cb67-17"><a href="#cb67-17" tabindex="-1"></a>D[i] <span class="ot">&lt;-</span> <span class="fu">CramerVonMisesTwoSamples</span>(x1, y1)</span>
<span id="cb67-18"><a href="#cb67-18" tabindex="-1"></a>}</span>
<span id="cb67-19"><a href="#cb67-19" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(D0, D) <span class="sc">&gt;=</span> D0)</span>
<span id="cb67-20"><a href="#cb67-20" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn =</span> <span class="dv">0</span>)</span>
<span id="cb67-21"><a href="#cb67-21" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>## [1] 0.418</code></pre>
</div>
<div id="question-15" class="section level3">
<h3>Question</h3>
<p>The Count 5 test for equal variances in Section 6.4 is based on the
maximum number of extreme points. Example 6.15 shows that the Count 5
criterion is not applicable for unequal sample sizes. Implement a
permutation test for equal variance based on the maximum number of
extreme points that applies when sample sizes are not necessarily
equal.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20231105</span>)</span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a>count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb69-3"><a href="#cb69-3" tabindex="-1"></a>X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb69-4"><a href="#cb69-4" tabindex="-1"></a>Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb69-5"><a href="#cb69-5" tabindex="-1"></a>outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb69-6"><a href="#cb69-6" tabindex="-1"></a>outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb69-7"><a href="#cb69-7" tabindex="-1"></a><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb69-8"><a href="#cb69-8" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)) <span class="sc">&gt;</span> <span class="dv">5</span>))</span>
<span id="cb69-9"><a href="#cb69-9" tabindex="-1"></a>}</span>
<span id="cb69-10"><a href="#cb69-10" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span> <span class="co">#number of replicates</span></span>
<span id="cb69-11"><a href="#cb69-11" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb69-12"><a href="#cb69-12" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb69-13"><a href="#cb69-13" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb69-14"><a href="#cb69-14" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb69-15"><a href="#cb69-15" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb69-16"><a href="#cb69-16" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb69-17"><a href="#cb69-17" tabindex="-1"></a>X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x) <span class="co">#centered by sample mean</span></span>
<span id="cb69-18"><a href="#cb69-18" tabindex="-1"></a>Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb69-19"><a href="#cb69-19" tabindex="-1"></a>z<span class="ot">&lt;-</span> <span class="fu">c</span>(X,Y)</span>
<span id="cb69-20"><a href="#cb69-20" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span></span>
<span id="cb69-21"><a href="#cb69-21" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R) <span class="co">#storage for replicates</span></span>
<span id="cb69-22"><a href="#cb69-22" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb69-23"><a href="#cb69-23" tabindex="-1"></a>D0 <span class="ot">&lt;-</span> <span class="fu">count5test</span>(X, Y)</span>
<span id="cb69-24"><a href="#cb69-24" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb69-25"><a href="#cb69-25" tabindex="-1"></a><span class="co">#generate indices k for the first sample</span></span>
<span id="cb69-26"><a href="#cb69-26" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb69-27"><a href="#cb69-27" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> z[k]</span>
<span id="cb69-28"><a href="#cb69-28" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k] <span class="co">#complement of x1</span></span>
<span id="cb69-29"><a href="#cb69-29" tabindex="-1"></a>D[i] <span class="ot">&lt;-</span> <span class="fu">count5test</span>(x1, y1)</span>
<span id="cb69-30"><a href="#cb69-30" tabindex="-1"></a>}</span>
<span id="cb69-31"><a href="#cb69-31" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(D0 <span class="sc">==</span> <span class="dv">0</span>, <span class="fu">mean</span>( <span class="fu">c</span>(D0, D) <span class="sc">&gt;</span> D0 ), <span class="fu">mean</span>( <span class="fu">c</span>(D0, D) <span class="sc">&gt;=</span> D0 ))</span>
<span id="cb69-32"><a href="#cb69-32" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn =</span> <span class="dv">0</span>)</span>
<span id="cb69-33"><a href="#cb69-33" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>## [1] 0.104</code></pre>
</div>
</div>
<div id="hw7" class="section level2">
<h2>hw7</h2>
<div id="question-16" class="section level3">
<h3>Question</h3>
<ol style="list-style-type: decimal">
<li>Consider a model <span class="math inline">\(P\left(Y=1 \mid X_1,
X_2, X_3\right)=\frac{\exp \left(a+b_1 X_1+b_2 X_2+b_3
X_3\right)}{1+\exp \left(a+b_1 X_1+b_2 X_2+b_3 X_3\right)}\)</span>,
where <span class="math inline">\(X_1 \sim P(1), X_2 \sim
\operatorname{Exp}(1)\)</span> and <span class="math inline">\(X_3 \sim
B(1,0.5)\)</span>.</li>
</ol>
<ul>
<li>Design a function that takes as input values <span class="math inline">\(N, b_1, b_2, b_3\)</span> and <span class="math inline">\(f_0\)</span>, and produces the output <span class="math inline">\(a\)</span>.</li>
<li>Call this function, input values are <span class="math inline">\(N=10^6, b_1=0, b_2=1, b_3=-1,
f_0=0.1,0.01,0.001,0.0001\)</span>.</li>
<li>Plot <span class="math inline">\(-\log f_0\)</span> vs <span class="math inline">\(a\)</span>.</li>
</ul>
<p>Sol</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20231112</span>)</span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a>my.root<span class="ot">&lt;-</span> <span class="cf">function</span> (N,b1,b2,b3,f0)    {</span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N,<span class="dv">1</span>);x2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(N,<span class="dv">1</span>); x3 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,N,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha){</span>
<span id="cb71-5"><a href="#cb71-5" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>alpha<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3); p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb71-6"><a href="#cb71-6" tabindex="-1"></a><span class="fu">mean</span>(p) <span class="sc">-</span> f0</span>
<span id="cb71-7"><a href="#cb71-7" tabindex="-1"></a>}</span>
<span id="cb71-8"><a href="#cb71-8" tabindex="-1"></a>solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1000</span>,<span class="dv">1000</span>))</span>
<span id="cb71-9"><a href="#cb71-9" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">unlist</span>(solution),<span class="dv">5</span>)[<span class="dv">1</span>]   }</span>
<span id="cb71-10"><a href="#cb71-10" tabindex="-1"></a><span class="fu">my.root</span>(<span class="at">N=</span><span class="fl">1e6</span>,<span class="at">b1=</span><span class="dv">0</span>,<span class="at">b2=</span><span class="dv">1</span>,<span class="at">b3=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">f0=</span><span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>##     root 
## -3.16449</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="fu">my.root</span>(<span class="at">N=</span><span class="fl">1e6</span>,<span class="at">b1=</span><span class="dv">0</span>,<span class="at">b2=</span><span class="dv">1</span>,<span class="at">b3=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">f0=</span><span class="fl">0.01</span>)</span></code></pre></div>
<pre><code>##     root 
## -6.06838</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="fu">my.root</span>(<span class="at">N=</span><span class="fl">1e6</span>,<span class="at">b1=</span><span class="dv">0</span>,<span class="at">b2=</span><span class="dv">1</span>,<span class="at">b3=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">f0=</span><span class="fl">0.001</span>)</span></code></pre></div>
<pre><code>##    root 
## -8.7306</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="fu">my.root</span>(<span class="at">N=</span><span class="fl">1e6</span>,<span class="at">b1=</span><span class="dv">0</span>,<span class="at">b2=</span><span class="dv">1</span>,<span class="at">b3=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">f0=</span><span class="fl">0.0001</span>)</span></code></pre></div>
<pre><code>##      root 
## -11.26707</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length=</span><span class="dv">100</span>)</span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a>vecroot<span class="ot">&lt;-</span> <span class="fu">Vectorize</span>(my.root)</span>
<span id="cb79-3"><a href="#cb79-3" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">vecroot</span>(<span class="at">N=</span><span class="fl">1e6</span>,<span class="at">b1=</span><span class="dv">0</span>,<span class="at">b2=</span><span class="dv">1</span>,<span class="at">b3=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">f0=</span>f)</span>
<span id="cb79-4"><a href="#cb79-4" tabindex="-1"></a><span class="fu">plot</span>(<span class="sc">-</span><span class="fu">log</span>(f),a,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-9.4" class="section level3">
<h3>Question 9.4</h3>
<p>Implement a random walk Metropolis sampler for generating the
standard Laplace distribution (see Exercise 3.2). For the increment,
simulate from a normal distribution. Compare the chains generated when
different variances are used for the proposal distribution. Also,
compute the acceptance rates of each chain.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20231112</span>)</span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a> lapla <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x))</span>
<span id="cb80-3"><a href="#cb80-3" tabindex="-1"></a> </span>
<span id="cb80-4"><a href="#cb80-4" tabindex="-1"></a> rw.Metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb80-5"><a href="#cb80-5" tabindex="-1"></a>   x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb80-6"><a href="#cb80-6" tabindex="-1"></a>   x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb80-7"><a href="#cb80-7" tabindex="-1"></a>   u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb80-8"><a href="#cb80-8" tabindex="-1"></a>   k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb80-9"><a href="#cb80-9" tabindex="-1"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb80-10"><a href="#cb80-10" tabindex="-1"></a>     y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb80-11"><a href="#cb80-11" tabindex="-1"></a>     <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> (<span class="fu">lapla</span>(y) <span class="sc">/</span> <span class="fu">lapla</span>(x[i<span class="dv">-1</span>])))</span>
<span id="cb80-12"><a href="#cb80-12" tabindex="-1"></a>       x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span> {</span>
<span id="cb80-13"><a href="#cb80-13" tabindex="-1"></a>         x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb80-14"><a href="#cb80-14" tabindex="-1"></a>         k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb80-15"><a href="#cb80-15" tabindex="-1"></a>       }</span>
<span id="cb80-16"><a href="#cb80-16" tabindex="-1"></a>   }</span>
<span id="cb80-17"><a href="#cb80-17" tabindex="-1"></a>   <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x, <span class="at">k=</span>k<span class="sc">/</span>N))</span>
<span id="cb80-18"><a href="#cb80-18" tabindex="-1"></a> }</span>
<span id="cb80-19"><a href="#cb80-19" tabindex="-1"></a> </span>
<span id="cb80-20"><a href="#cb80-20" tabindex="-1"></a> N <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb80-21"><a href="#cb80-21" tabindex="-1"></a> sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">5</span>,<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>,<span class="dv">15</span>)</span>
<span id="cb80-22"><a href="#cb80-22" tabindex="-1"></a> x0 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb80-23"><a href="#cb80-23" tabindex="-1"></a> rw1 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb80-24"><a href="#cb80-24" tabindex="-1"></a> rw2 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb80-25"><a href="#cb80-25" tabindex="-1"></a> rw3 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb80-26"><a href="#cb80-26" tabindex="-1"></a> rw4 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb80-27"><a href="#cb80-27" tabindex="-1"></a> rw5 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">5</span>], x0, N)</span>
<span id="cb80-28"><a href="#cb80-28" tabindex="-1"></a> rw6 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">6</span>], x0, N)</span>
<span id="cb80-29"><a href="#cb80-29" tabindex="-1"></a> <span class="fu">plot</span>(rw1<span class="sc">$</span>x,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a> <span class="fu">plot</span>(rw2<span class="sc">$</span>x,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a> <span class="fu">plot</span>(rw3<span class="sc">$</span>x,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a> <span class="fu">plot</span>(rw4<span class="sc">$</span>x,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a> <span class="fu">plot</span>(rw5<span class="sc">$</span>x,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a> <span class="fu">plot</span>(rw6<span class="sc">$</span>x,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(rw1<span class="sc">$</span>k, rw2<span class="sc">$</span>k, rw3<span class="sc">$</span>k, rw4<span class="sc">$</span>k,rw5<span class="sc">$</span>k,rw6<span class="sc">$</span>k))</span></code></pre></div>
<pre><code>## [1] 0.0205 0.1720 0.3130 0.4790 0.6995 0.9130</code></pre>
</div>
<div id="question-17" class="section level3">
<h3>Question</h3>
<p>Implement a Gibbs sampler to generate a bivariate normal chain (Xt,
Yt) with zero means, unit standard deviations, and correlation 0.9. Plot
the generated sample after discarding a suitable burn-in sample. Fit a
simple linear regression model Y = β0 + β1X to the sample and check the
residuals of the model for normality and constant variance</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a> N<span class="ot">&lt;-</span><span class="dv">2000</span></span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a> </span>
<span id="cb88-3"><a href="#cb88-3" tabindex="-1"></a> </span>
<span id="cb88-4"><a href="#cb88-4" tabindex="-1"></a>   x<span class="ot">&lt;-</span>y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb88-5"><a href="#cb88-5" tabindex="-1"></a>   x[<span class="dv">1</span>]<span class="ot">&lt;-</span>y[<span class="dv">1</span>] <span class="ot">&lt;-</span><span class="dv">0</span> </span>
<span id="cb88-6"><a href="#cb88-6" tabindex="-1"></a>   u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb88-7"><a href="#cb88-7" tabindex="-1"></a>   k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb88-8"><a href="#cb88-8" tabindex="-1"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb88-9"><a href="#cb88-9" tabindex="-1"></a>     x0<span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.9</span><span class="sc">*</span>y[i<span class="dv">-1</span>],<span class="fu">sqrt</span>(<span class="fl">0.19</span>))</span>
<span id="cb88-10"><a href="#cb88-10" tabindex="-1"></a>     y0 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.9</span><span class="sc">*</span>x[i<span class="dv">-1</span>], <span class="fu">sqrt</span>(<span class="fl">0.19</span>))</span>
<span id="cb88-11"><a href="#cb88-11" tabindex="-1"></a>     </span>
<span id="cb88-12"><a href="#cb88-12" tabindex="-1"></a>     x[i] <span class="ot">&lt;-</span> x0 </span>
<span id="cb88-13"><a href="#cb88-13" tabindex="-1"></a>     y[i] <span class="ot">&lt;-</span> y0</span>
<span id="cb88-14"><a href="#cb88-14" tabindex="-1"></a>   </span>
<span id="cb88-15"><a href="#cb88-15" tabindex="-1"></a>   }</span>
<span id="cb88-16"><a href="#cb88-16" tabindex="-1"></a> </span>
<span id="cb88-17"><a href="#cb88-17" tabindex="-1"></a> li<span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x)</span>
<span id="cb88-18"><a href="#cb88-18" tabindex="-1"></a> <span class="fu">plot</span>(li)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA8FBMVEUAAAAAABcAACEAACgAACoAADoAAGYAKlEAMZAAOoEAOpAAZrYNAAAXABcXACgXKJAgAGYoAGYxAAAxAGYxOpA6AAA6ADo6AGY6MlE6Ojo6OmY6OpA6kLY6kNtJAABYAABYAA1YABdYADpmAABmACFmADpmAGZmKABmMlFmOpBmZmZmtrZmtv9m2/+B//+QOgCQOiqQOjqQOmaQZgCQkGaQnGaQtpCQtv+QvJCQ27aQ2/+c//+2ZgC225C2/7a2/9u2///bkDrbtmbb25Db/7bb/9vb///fU2v/tmb/vFH/22b/25D//4H//7b//9v///8hLyRHAAAACXBIWXMAAA7DAAAOwwHHb6hkAAATLElEQVR4nO2dCWPkNhWAxZEFstyQLRDCFbZAd9pQytGGaZuhJTUME/3/f4Ml6+k9XX4aWZp4E73dJDO2bEmf3yX5ErLLrIjHbsDapQNipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANipANiRHRC86IBCUceu0nrks6DEQR0uL6SOyHO7x+zOesTBLQ9v99fvJTbl4/ZnPWJBXS43shBjD8v7h61QWsTB9B2hLPrgBwhJvbycH1+f7juJuYIddLi7PbhpvNxpYd5RjogRiZAo3lZaeykdVXROlSYcGXLJ2XDJrJdTTm1BqlMYuz52W24qgRQWzhKTg1oykOjsWDtgMDMmpqYQ2Yc2Aj1dTv+3ZjOqmVXUAABDbDY3WZ/MY6NvtSQTInD9Ztrvbda4gw1di/HKtsekkFYQrvRztQAUCnV9Hmj/+4vgJAFpAxTZ2ixbTRYKHG4HpfuYhZcKCSTvpLD2KBd49GqOuhaSVWFuuLXt1Ifl7Gj0zI72gFADzd68dltbBv945aoeZSdocb+nTv901geboRWFOzFILQCbAZ96O0aADQtGH/HtplaDiW0OtX0TBaQOgbqwJwA0CjjqG//ytjB6FZefDppw2BSjSigcX1sGwJI62ArQHqUur1qbGKgAqOq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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the plot, we can judge that the residuals are normal and
variance-constant.</p>
<p>###　Question Refer to Example 9.1. Use the Gelman-Rubin method to
monitor convergence of the chain, and run the chain until the chain has
converged approximately to the target distribution according to R &lt; ˆ
1.2. (See Exercise 9.9.) Also use the coda [212] package to check for
convergence of the chain by the Gelman-Rubin method. Hints: See the help
topics for the coda functions gelman.diag, gelman.plot, as.mcmc, and
mcmc.list.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20231112</span>)</span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a><span class="do">## 函数</span></span>
<span id="cb89-3"><a href="#cb89-3" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb89-4"><a href="#cb89-4" tabindex="-1"></a><span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb89-5"><a href="#cb89-5" tabindex="-1"></a><span class="co"># for chain in i-th row of X</span></span>
<span id="cb89-6"><a href="#cb89-6" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb89-7"><a href="#cb89-7" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb89-8"><a href="#cb89-8" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb89-9"><a href="#cb89-9" tabindex="-1"></a>psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb89-10"><a href="#cb89-10" tabindex="-1"></a>B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb89-11"><a href="#cb89-11" tabindex="-1"></a>psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb89-12"><a href="#cb89-12" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb89-13"><a href="#cb89-13" tabindex="-1"></a>v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb89-14"><a href="#cb89-14" tabindex="-1"></a>r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W <span class="co">#G-R statistic</span></span>
<span id="cb89-15"><a href="#cb89-15" tabindex="-1"></a><span class="fu">return</span>(r.hat)</span>
<span id="cb89-16"><a href="#cb89-16" tabindex="-1"></a>}</span>
<span id="cb89-17"><a href="#cb89-17" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, sigma) {</span>
<span id="cb89-18"><a href="#cb89-18" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">any</span>(x <span class="sc">&lt;</span> <span class="dv">0</span>)) <span class="fu">return</span> (<span class="dv">0</span>)</span>
<span id="cb89-19"><a href="#cb89-19" tabindex="-1"></a><span class="fu">stopifnot</span>(sigma <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb89-20"><a href="#cb89-20" tabindex="-1"></a><span class="fu">return</span>((x <span class="sc">/</span> sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb89-21"><a href="#cb89-21" tabindex="-1"></a>}</span>
<span id="cb89-22"><a href="#cb89-22" tabindex="-1"></a>Rai.chain<span class="ot">&lt;-</span><span class="cf">function</span>(sigma, m, x1) {</span>
<span id="cb89-23"><a href="#cb89-23" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb89-24"><a href="#cb89-24" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb89-25"><a href="#cb89-25" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df=</span><span class="dv">1</span>)</span>
<span id="cb89-26"><a href="#cb89-26" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb89-27"><a href="#cb89-27" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb89-28"><a href="#cb89-28" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb89-29"><a href="#cb89-29" tabindex="-1"></a>xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb89-30"><a href="#cb89-30" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df =</span> xt)</span>
<span id="cb89-31"><a href="#cb89-31" tabindex="-1"></a>num <span class="ot">&lt;-</span> <span class="fu">f</span>(y, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(xt, <span class="at">df =</span> y)</span>
<span id="cb89-32"><a href="#cb89-32" tabindex="-1"></a>den <span class="ot">&lt;-</span> <span class="fu">f</span>(xt, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(y, <span class="at">df =</span> xt)</span>
<span id="cb89-33"><a href="#cb89-33" tabindex="-1"></a><span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> num<span class="sc">/</span>den) x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span> {</span>
<span id="cb89-34"><a href="#cb89-34" tabindex="-1"></a>x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb89-35"><a href="#cb89-35" tabindex="-1"></a>k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span> <span class="co">#y is rejected</span></span>
<span id="cb89-36"><a href="#cb89-36" tabindex="-1"></a>}</span>
<span id="cb89-37"><a href="#cb89-37" tabindex="-1"></a>}</span>
<span id="cb89-38"><a href="#cb89-38" tabindex="-1"></a>x</span>
<span id="cb89-39"><a href="#cb89-39" tabindex="-1"></a>}</span>
<span id="cb89-40"><a href="#cb89-40" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> .<span class="dv">2</span> <span class="co">#parameter of proposal distribution</span></span>
<span id="cb89-41"><a href="#cb89-41" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co">#number of chains to generate</span></span>
<span id="cb89-42"><a href="#cb89-42" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20000</span><span class="co">#length of chains</span></span>
<span id="cb89-43"><a href="#cb89-43" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co">#burn-in length</span></span>
<span id="cb89-44"><a href="#cb89-44" tabindex="-1"></a><span class="co">#choose overdispersed initial values</span></span>
<span id="cb89-45"><a href="#cb89-45" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb89-46"><a href="#cb89-46" tabindex="-1"></a><span class="co">#generate the chains</span></span>
<span id="cb89-47"><a href="#cb89-47" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb89-48"><a href="#cb89-48" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb89-49"><a href="#cb89-49" tabindex="-1"></a>X[i, ] <span class="ot">&lt;-</span> <span class="fu">Rai.chain</span>(sigma, n, x0[i])</span>
<span id="cb89-50"><a href="#cb89-50" tabindex="-1"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb89-51"><a href="#cb89-51" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb89-52"><a href="#cb89-52" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb89-53"><a href="#cb89-53" tabindex="-1"></a>psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb89-54"><a href="#cb89-54" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.087344</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a><span class="co">#plot psi for the four chains</span></span>
<span id="cb91-2"><a href="#cb91-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb91-3"><a href="#cb91-3" tabindex="-1"></a><span class="fu">plot</span>(psi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb91-4"><a href="#cb91-4" tabindex="-1"></a><span class="at">xlab=</span>i, <span class="at">ylab=</span><span class="fu">bquote</span>(psi))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb92-3"><a href="#cb92-3" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb92-4"><a href="#cb92-4" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb92-5"><a href="#cb92-5" tabindex="-1"></a>rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb92-6"><a href="#cb92-6" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb92-7"><a href="#cb92-7" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAATlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6Ojo6OpA6kNtmAABmtv+QOgCQZgCQ2/+2ZgC2///bkDrbkJDb2//b////tmb/25D//7b//9v///+Kp0OTAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAE1klEQVR4nO3d63KaQABAYdJc2iQ21jYk5v1ftFyUdGqWwy6sKJzzp8zYRecrrNC4pviw3oq5X8ClJxAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAUB7TfFE3ffmV6OZdXFNCueGw3yuPG8osB2m86lt3ta4YXc4nFAL0/PR83y9WcZB5BUOQcdDiEnIMCvT+172LB46e4mvIAnXt3+RIIyg20C7yLCRTYS/SpPXeeYpBAUE6gsihuXqbb3TxlAtoWxePbj9d/bzrG7G7G8gBtqwvEbXP0hG411g3UHDdvDzVQ6GZ17UD1Hdj+z4dHUKDu8rClGru7Ocs0Se/at6+yCMzRqwc69+7yJRAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQ5E9WIY8gSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIICgTEK5ZXTkQr1ldN9CAFYfrBhqwZnUNQL+Dy3VXfQTtDjPvftOznpnXrC4WqLx5aRYalEXvcl1eszr8Jc5bJNB+c9dMMbvwOp6Jn3fuIoGaT87vN9+Lu3M979xFA9WTy3b4avi1rVk9ACV/ncLif7J6ABp7gi3+CBIo9BeHAlVXS+2l0PrmoM9ZpO9CsboIeH+qGdcGNKz2VmO/qeZygb7qeLNavdsJ9FXdzer2TqAvO7JUU5ZAX3a8nQ/e868d6Ny7y5dAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQNCZgRb/k9XzP+/cCQQJBAkECQQJBAkECQQJBAkECQQJBAkECQRlAuIlmYf/8rj8P7MAuSSzv1UvqBuSSzIhjyBq6JLMYlQxryi5TO9i51iSOU536D+A10GQQFBuIJciRD7deWfYCfIUgwSCBIIEgjLdi31OxqF3saspB1D/V8NE7BQeH/fw2OGj/nrzJSjjd7pcoJ7fjxmz0wUDTbNTgcY9LpBA4x4XSKBxjy8faEkJBAkECQQJBAkECQQJBAkECQQJBAkECQRND1QWCV9r3n5Tczf0dKOn7gtm04ZDkwPV345fxr6qsvlIVjf0dKOn+gtmm58lpA2npgZqP8cY+cXL7081UDf0dKP3Ce9Co5Jey/9NDfR2Xx/toY8PBdrd/qyAuqGnGz1jO6C04djkQA/1ER36lHBwTD0HdUNPN/pGH0+xxOHU1EDtKR914tdnQvM7PY5DTzf6n7KdiVOHQxcAVH/megTQtjpC3u4frwUo/rBuRqSfYp8zznWcYvET4+7weZTntFm2O0yuZJJOfGvdJr/NtwrVYXIlb/OJF2fb9AvF4xx0JReKzSmTeqvRDT3d6BtbHH6lVdpwyJtVSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIOgvB1MWKeb3HVcAAAAASUVORK5CYII=" /><!-- -->
## hw8</p>
<p>###　Question In the Morra game, the set of optimal strategies are
not changed if a constant is subtracted from every entry of the payoff
matrix, or a positive constant is multiplied times every entry of the
payoff matrix. However, the simplex algorithm may terminate at a
different basic feasible point (also optimal). Compute B &lt;- A + 2,
find the solution of game B, and verify that it is one of the extreme
points (11.12)–(11.15) of the original game A. Also find the value of
game A and game B.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a><span class="co">#enter the payoff matrix</span></span>
<span id="cb93-3"><a href="#cb93-3" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>( <span class="dv">0</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb93-4"><a href="#cb93-4" tabindex="-1"></a><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb93-5"><a href="#cb93-5" tabindex="-1"></a><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,</span>
<span id="cb93-6"><a href="#cb93-6" tabindex="-1"></a><span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb93-7"><a href="#cb93-7" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb93-8"><a href="#cb93-8" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb93-9"><a href="#cb93-9" tabindex="-1"></a><span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb93-10"><a href="#cb93-10" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb93-11"><a href="#cb93-11" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="dv">0</span>), <span class="dv">9</span>, <span class="dv">9</span>)</span>
<span id="cb93-12"><a href="#cb93-12" tabindex="-1"></a>B<span class="ot">&lt;-</span> A<span class="sc">+</span><span class="dv">2</span></span>
<span id="cb93-13"><a href="#cb93-13" tabindex="-1"></a>solve.game <span class="ot">&lt;-</span> <span class="cf">function</span>(A) {</span>
<span id="cb93-14"><a href="#cb93-14" tabindex="-1"></a><span class="co">#solve the two player zero-sum game by simplex method</span></span>
<span id="cb93-15"><a href="#cb93-15" tabindex="-1"></a><span class="co">#optimize for player 1, then player 2</span></span>
<span id="cb93-16"><a href="#cb93-16" tabindex="-1"></a><span class="co">#maximize v subject to ...</span></span>
<span id="cb93-17"><a href="#cb93-17" tabindex="-1"></a><span class="co">#let x strategies 1:m, and put v as extra variable</span></span>
<span id="cb93-18"><a href="#cb93-18" tabindex="-1"></a><span class="co">#A1, the &lt;= constraints</span></span>
<span id="cb93-19"><a href="#cb93-19" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb93-20"><a href="#cb93-20" tabindex="-1"></a>min.A <span class="ot">&lt;-</span> <span class="fu">min</span>(A)</span>
<span id="cb93-21"><a href="#cb93-21" tabindex="-1"></a>A <span class="ot">&lt;-</span> A <span class="sc">-</span> min.A <span class="co">#so that v &gt;= 0</span></span>
<span id="cb93-22"><a href="#cb93-22" tabindex="-1"></a>max.A <span class="ot">&lt;-</span> <span class="fu">max</span>(A)</span>
<span id="cb93-23"><a href="#cb93-23" tabindex="-1"></a>A <span class="ot">&lt;-</span> A <span class="sc">/</span> <span class="fu">max</span>(A)</span>
<span id="cb93-24"><a href="#cb93-24" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb93-25"><a href="#cb93-25" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(A)</span>
<span id="cb93-26"><a href="#cb93-26" tabindex="-1"></a>it <span class="ot">&lt;-</span> n<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb93-27"><a href="#cb93-27" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, m), <span class="dv">1</span>) <span class="co">#objective function</span></span>
<span id="cb93-28"><a href="#cb93-28" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">cbind</span>(<span class="fu">t</span>(A), <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, n)) <span class="co">#constraints &lt;=</span></span>
<span id="cb93-29"><a href="#cb93-29" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb93-30"><a href="#cb93-30" tabindex="-1"></a>A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, m), <span class="dv">0</span>))) <span class="co">#constraints sum(x)=1</span></span>
<span id="cb93-31"><a href="#cb93-31" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb93-32"><a href="#cb93-32" tabindex="-1"></a>sx <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>a, <span class="at">A1=</span>A1, <span class="at">b1=</span>b1, <span class="at">A3=</span>A3, <span class="at">b3=</span>b3,</span>
<span id="cb93-33"><a href="#cb93-33" tabindex="-1"></a><span class="at">maxi=</span><span class="cn">TRUE</span>, <span class="at">n.iter=</span>it)</span>
<span id="cb93-34"><a href="#cb93-34" tabindex="-1"></a><span class="co">#the ’solution’ is [x1,x2,...,xm | value of game]</span></span>
<span id="cb93-35"><a href="#cb93-35" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb93-36"><a href="#cb93-36" tabindex="-1"></a><span class="co">#minimize v subject to ...</span></span>
<span id="cb93-37"><a href="#cb93-37" tabindex="-1"></a><span class="co">#let y strategies 1:n, with v as extra variable</span></span>
<span id="cb93-38"><a href="#cb93-38" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n), <span class="dv">1</span>) <span class="co">#objective function</span></span>
<span id="cb93-39"><a href="#cb93-39" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(A, <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, m)) <span class="co">#constraints &lt;=</span></span>
<span id="cb93-40"><a href="#cb93-40" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)</span>
<span id="cb93-41"><a href="#cb93-41" tabindex="-1"></a>A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n), <span class="dv">0</span>))) <span class="co">#constraints sum(y)=1</span></span>
<span id="cb93-42"><a href="#cb93-42" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb93-43"><a href="#cb93-43" tabindex="-1"></a>sy <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>a, <span class="at">A1=</span>A1, <span class="at">b1=</span>b1, <span class="at">A3=</span>A3, <span class="at">b3=</span>b3,</span>
<span id="cb93-44"><a href="#cb93-44" tabindex="-1"></a><span class="at">maxi=</span><span class="cn">FALSE</span>, <span class="at">n.iter=</span>it)</span>
<span id="cb93-45"><a href="#cb93-45" tabindex="-1"></a>soln <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;A&quot;</span> <span class="ot">=</span> A <span class="sc">*</span> max.A <span class="sc">+</span> min.A,</span>
<span id="cb93-46"><a href="#cb93-46" tabindex="-1"></a><span class="st">&quot;x&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>m],</span>
<span id="cb93-47"><a href="#cb93-47" tabindex="-1"></a><span class="st">&quot;y&quot;</span> <span class="ot">=</span> sy<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>n],</span>
<span id="cb93-48"><a href="#cb93-48" tabindex="-1"></a><span class="st">&quot;v&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[m<span class="sc">+</span><span class="dv">1</span>] <span class="sc">*</span> max.A <span class="sc">+</span> min.A)</span>
<span id="cb93-49"><a href="#cb93-49" tabindex="-1"></a>soln</span>
<span id="cb93-50"><a href="#cb93-50" tabindex="-1"></a>}</span>
<span id="cb93-51"><a href="#cb93-51" tabindex="-1"></a>sB <span class="ot">&lt;-</span> <span class="fu">solve.game</span>(B)</span>
<span id="cb93-52"><a href="#cb93-52" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cbind</span>(sB<span class="sc">$</span>x, sB<span class="sc">$</span>y), <span class="dv">7</span>)</span></code></pre></div>
<pre><code>##         [,1]      [,2]
## x1 0.0000000 0.0000000
## x2 0.0000000 0.0000000
## x3 0.4098361 0.4098361
## x4 0.0000000 0.0000000
## x5 0.3278689 0.3278689
## x6 0.0000000 0.0000000
## x7 0.2622951 0.2622951
## x8 0.0000000 0.0000000
## x9 0.0000000 0.0000000</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a>C<span class="ot">&lt;-</span> A<span class="sc">+</span>B</span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a>sC <span class="ot">&lt;-</span> <span class="fu">solve.game</span>(C)</span>
<span id="cb95-3"><a href="#cb95-3" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cbind</span>(sC<span class="sc">$</span>x, sC<span class="sc">$</span>y), <span class="dv">7</span>)</span></code></pre></div>
<pre><code>##         [,1]      [,2]
## x1 0.0000000 0.0000000
## x2 0.0000000 0.0000000
## x3 0.4098361 0.4098361
## x4 0.0000000 0.0000000
## x5 0.3278689 0.3278689
## x6 0.0000000 0.0000000
## x7 0.2622951 0.2622951
## x8 0.0000000 0.0000000
## x9 0.0000000 0.0000000</code></pre>
<p>Notice that the solutions obtained by the simplex method in this
example correspond to the extreme point (11.15)</p>
</div>
</div>
<div id="hw9" class="section level2">
<h2>hw9</h2>
<div id="question-2-1" class="section level3">
<h3>Question 2</h3>
<p>This example appears in~. Consider the bivariate density <span class="math display">\[
f(x, y) \propto \binom{n}{x} y^{x+a-1} (1 - y)^{n-x+b-1}, \quad x = 0,
1, \ldots, n, \quad 0 \leq y \leq 1.
\]</span> It can be shown (see e.g.~) that for fixed <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, <span class="math inline">\(n\)</span>, the conditional distributions are
Binomial<span class="math inline">\((n, y)\)</span> and Beta<span class="math inline">\((x+a, n-x+b)\)</span>. Use the Gibbs sampler to
generate a chain with target joint density <span class="math inline">\(f(x, y)\)</span>. ) - Write an R function. - Write
an Rcpp function. - Compare the computation time of the two functions
with the function “microbenchmark”.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb97-2"><a href="#cb97-2" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb97-3"><a href="#cb97-3" tabindex="-1"></a> gibbs_r <span class="ot">&lt;-</span> <span class="cf">function</span>(N, thin , n,a,b) {</span>
<span id="cb97-4"><a href="#cb97-4" tabindex="-1"></a>    mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> N, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb97-5"><a href="#cb97-5" tabindex="-1"></a>    x <span class="ot">&lt;-</span> y <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb97-6"><a href="#cb97-6" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb97-7"><a href="#cb97-7" tabindex="-1"></a>      <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>thin) {</span>
<span id="cb97-8"><a href="#cb97-8" tabindex="-1"></a>        x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb97-9"><a href="#cb97-9" tabindex="-1"></a>        y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb97-10"><a href="#cb97-10" tabindex="-1"></a>      }</span>
<span id="cb97-11"><a href="#cb97-11" tabindex="-1"></a>      mat[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb97-12"><a href="#cb97-12" tabindex="-1"></a>    }</span>
<span id="cb97-13"><a href="#cb97-13" tabindex="-1"></a>    mat</span>
<span id="cb97-14"><a href="#cb97-14" tabindex="-1"></a> }</span>
<span id="cb97-15"><a href="#cb97-15" tabindex="-1"></a> dir_cpp <span class="ot">&lt;-</span> <span class="st">&#39;C:/Users/11146/Desktop/studying/Rlab/statcomp/hw9/&#39;</span></span>
<span id="cb97-16"><a href="#cb97-16" tabindex="-1"></a> <span class="fu">sourceCpp</span>(<span class="fu">paste0</span>(dir_cpp,<span class="st">&quot;gibbsC.cpp&quot;</span>))</span>
<span id="cb97-17"><a href="#cb97-17" tabindex="-1"></a> ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(</span>
<span id="cb97-18"><a href="#cb97-18" tabindex="-1"></a> <span class="fu">gibbs_r</span>(<span class="dv">100</span>, <span class="dv">10</span> , <span class="dv">10</span> , <span class="dv">5</span>,<span class="dv">5</span>),</span>
<span id="cb97-19"><a href="#cb97-19" tabindex="-1"></a> <span class="fu">gibbs_cpp</span>(<span class="dv">100</span>, <span class="dv">10</span> , <span class="dv">10</span>,<span class="dv">5</span>,<span class="dv">5</span>)</span>
<span id="cb97-20"><a href="#cb97-20" tabindex="-1"></a> )</span>
<span id="cb97-21"><a href="#cb97-21" tabindex="-1"></a> <span class="fu">summary</span>(ts)</span></code></pre></div>
<pre><code>##                           expr    min      lq     mean  median      uq     max
## 1   gibbs_r(100, 10, 10, 5, 5) 3155.4 3375.75 4177.689 3614.45 4111.05 11110.2
## 2 gibbs_cpp(100, 10, 10, 5, 5)  350.8  359.95  404.286  368.00  383.15  1460.7
##   neval
## 1   100
## 2   100</code></pre>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
